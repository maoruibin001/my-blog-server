# react-native踩坑笔记。 

2018年了，过完了2017这个平淡充实的一年。昨日偶逛朋友圈，发现一大堆18岁，恍然间发现自己已然痴长一岁。回首过去这一年，发生了几件对自己很重要的事，此时此刻如果要说感悟，自觉最深的应是成熟了，完成了从男孩到男人蜕变的最后阶段吧。

最近学习时间有所下降，客观原因是公司有个和我关系很近的员工离职，并且离开时把他的工作全部交给了我，这直接就导致我工作比以前多了近一倍，所以空闲时间就自然减少。中途自己也去面试了几个前端，都感觉不如人意，因此也只能一直接着做。工作的增加，学习时间的减少，目前搞得“最多”的应该是知微相关的东西了。

12月初的时候决定做一个知微平台，自己搭建好了项目构架，并写了些前后台代码，然后开源出去，希望群策群力搞好这个项目。刚开始的时候有好几十人感兴趣，并有20多人一起组建了一个微信群~知微小分队。然而实际也就我一人开发，目前为止只一人贡献过（并且还是一个设计的妹子贡献的网站logo），甚是惨淡。中途由于接手别人工作，开发需求，忙到12月下旬项目依旧没做出什么样子。12月下旬有两天空闲的日子，我就想着不如把app也一起搞出来，或许很多人对搞app感兴趣。

app目前首选是两种方案，一种是淘宝开源的weex，一种是react-native。前期做了些准备工作，心底里还是更偏向于国产，所以首先了解的是weex。了解过程中发现实在是坑太多，加上阿里自己都不上心，开源了几个月就把项目扔给了apache，自己却不管了，这让我很担心项目的未来，所以最终还是忍痛放弃了，选择了react-native。

决定用react-native做app后那就直接开搞，但是项目一上来就给了个下马威，环境一直搭建不成功，想着自己完全按照react-native中文网文章一步一步搭建项目（https://reactnative.cn/docs/0.51/getting-started.html）， 怎么别人行，自己就不行。中途就各种百度、google，到最后终于是把环境搭建好，并且在自己手机上出现了react-native欢迎页面，那已经是两天后了，我都有种要奔溃的感觉。其实最大的问题就一个，自己java版本是1.7的。中途虽然升级成了1.8，但是是32位的，这个百度软件中心只能下载32位的，到最后发现这个问题，并改成64位之后一切都能正常运行了。

项目运行起来后，陆续开发了两个模块，一个首页一个个人主页。
其中也遇到了些坑，如下：

### 1、react-native安装环境配置各种报错，服务不能启动。

- 解决方案：严格按照官方推荐配置，并一定注意java版本1.8。

### 2、启动项目引入React和Component报错

- 解决方案：采用项目依赖的react引入React和Component,不要从react-native中引入。

### 3、项目的排列方式为竖向排列。

- 解决方案：默认flexDerection 为 column，需要手动设置为 row。

### 4、TabNavigator和FlatList一起使用，底部内容被遮挡问题。

- 解决方案：给FlatList加一个margin(个人觉得这个方案并不好，虽然实现了效果，不过感觉很挫，但并没有找到好的实现方式)。

### 5、影藏TabNavigator时出现一个灰色的横条

- 解决方案：在TabNavigator上设置sceneStyle={{paddingBottom:0}}，当然这个值可以动态设置，但隐藏时必须设置为0。

### 6、搜索框外面加一个View，并设置对应的flex，键盘输入内容时不展示。

- 解决方案： 给外层View价格高度。

### 7、Image引入图片时source没用问题

- 解决方案：source对应资源为后端返回资源时使用source={{uri: xxx}}这种方式引入，所以就要求后端必须返回绝对地址，不能返回相对地址。相对地址引入采用require()的方式，但是require只能引入字符串对应的地址，不能引入变量对应地址。

### 8、在一个View中使用ScrollableTabView内容不展示问题

- 解决方案：需要给View设置一个高度，不然不会展示。

### 9、adb devices 之后能直接显示出连接设备，但是依旧报com.android.builder.testing.api.DeviceException: No connected devices!

- 解决方案： 将android文件夹下面的build.gradle文件第八行classpath 'com.android.tools.build:gradle:2.2.3'改为classpath 'com.android.tools.build:gradle:1.2.3'再运行就ok了，如果不ok，你再改回2.2.3运行应该就可以了。我也不知道原理，就是按照上面操作之后好了。

详细可参见我github，那里会持续有问题更新，https://github.com/maoruibin001/zhiwei-app
等做到现在，才发现其实很多坑都是别人踩过的。先不做项目，不熟悉这里面的东西，去看别人分享的经验又容易记不住。如果先做项目再去看别人踩过的坑又容易重复踩坑，反正没有直接的捷径。

短期内的打算是先完成知微项目，包括pc和app。同时也希望有小伙伴一起加入进来一起开发，让项目进度稍微快些。

